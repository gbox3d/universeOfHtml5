<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

        <script src="../libs/jquery-1.7.1.min.js" ></script>

        <script>

//출처 : http://www.javascriptkit.com/javatutors/loadjavascriptcss2.shtml

            function createjscssfile(filename, filetype) {
                if (filetype == "js") { //if filename is a external JavaScript file
                    var fileref = document.createElement('script')
                    fileref.setAttribute("type", "text/javascript")
                    fileref.setAttribute("src", filename)
                }
                else if (filetype == "css") { //if filename is an external CSS file
                    var fileref = document.createElement("link")
                    fileref.setAttribute("rel", "stylesheet")
                    fileref.setAttribute("type", "text/css")
                    fileref.setAttribute("href", filename)
                }
                return fileref
            }

            function removejscssfile(filename, filetype) {
                var targetelement = (filetype == "js") ? "script" : (filetype == "css") ? "link" : "none" //determine element type to create nodelist from
                var targetattr = (filetype == "js") ? "src" : (filetype == "css") ? "href" : "none" //determine corresponding attribute to test for
                var allsuspects = document.getElementsByTagName(targetelement)
                for (var i = allsuspects.length; i >= 0; i--) { //search backwards within nodelist for matching elements to remove
                    if (allsuspects[i] && allsuspects[i].getAttribute(targetattr) != null && allsuspects[i].getAttribute(targetattr).indexOf(filename) != -1)
                    {
                        allsuspects[i].parentNode.removeChild(allsuspects[i]) //remove element by calling parentNode.removeChild()
                        console.log(filename + ' removed!');

                    }


                }
            }
            function replacejscssfile(oldfilename, newfilename, filetype) {
                var targetelement = (filetype == "js") ? "script" : (filetype == "css") ? "link" : "none" //determine element type to create nodelist using
                var targetattr = (filetype == "js") ? "src" : (filetype == "css") ? "href" : "none" //determine corresponding attribute to test for
                var allsuspects = document.getElementsByTagName(targetelement)
                for (var i = allsuspects.length; i >= 0; i--) { //search backwards within nodelist for matching elements to remove
                    if (allsuspects[i] && allsuspects[i].getAttribute(targetattr) != null && allsuspects[i].getAttribute(targetattr).indexOf(oldfilename) != -1) {
                        var newelement = createjscssfile(newfilename, filetype)
                        allsuspects[i].parentNode.replaceChild(newelement, allsuspects[i])
                    }
                }
            }


            var filesadded = "";
            function LoadDLL(filename)
            {
                if (filesadded.indexOf("[" + filename + "]") == -1) {
                    var head = document.getElementsByTagName('head')[0];
                    var script = createjscssfile(filename, 'js');
                    script.onload = function() {
                        $('body').append($('<p>load ok</p>'));
                    }

                    filesadded += "[" + filename + "]";

                    head.appendChild(script);

                }
                else {
                    $('body').append($('<p></p>').text(filename + 'already loaded!'));
                }
            }

            function replace(oldelm,newelm) {
                replacejscssfile(oldelm,newelm,"js");
                $('body').append($('<p></p>').text(newelm + ' replaced'));

            }

            $(function() {
                $('#btn-load').on('click', function() {
                    LoadDLL('test.js');
                });
                $('#btn-replace').on('click', function() {
                    replace('test.js','test2.js');
                   
                });



                $('#btn-test').on('click', function() {
                    test();
                });

            })



        </script>




    </head>
    <body>
        <button id="btn-load">load test.js</button>
        <button id="btn-replace">replace test2.js</button>
        <button id="btn-test">call test</button>
    </body>
</html>
