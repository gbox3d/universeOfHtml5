<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="utf-8" />

        <title>캐릭터 움직이기 </title>

        <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="../../lib/std-jqm/css/themes/default/jquery.mobile-1.2.0.css"/>

        <script src="../../lib/std-jqm/js/jquery.js"></script>

        <script src="../../lib/std-jqm/js/jquery.mobile-1.2.0.js"></script>

        <link rel="stylesheet" href="engine2d.css" />
        <link rel="stylesheet" href="rpg_sprite.css" />
        <link rel="stylesheet" href="forest_tile.css" />

        <script>



            function tocss_Translate(x, y)
            {
                return 'translate(' + x + 'px,' + y + 'px' + ')';
            }

            var objx = 0;
            var objy = 0;

            function move_Object(obj, dest_x, dest_y)
            {
                var dist = (objx - (dest_x - 16)) * (objx - (dest_x - 16)) + (objy - (dest_y - 48)) * (objy - (dest_y - 48));

                dist = Math.sqrt(dist);

                var time = dist / 100; //1초에 100만큼 가기
                //console.log(time);


                objx = dest_x - 16;
                objy = dest_y - 48;

                $(obj).css('-webkit-transition', '-webkit-transform ' + time + 's');
                $(obj).css('-webkit-transform', tocss_Translate(objx, objy));

            }

            $(function() {


                for (var i = 0; i < 64; i++) {
                    var obj = $('<div></div>');
                    $('.gbox3d-2dgv-fullscreen').append(obj);

                    obj.addClass('sprite-32by48').addClass('character-img-fighter').addClass('character-anim-stand-0');

                    $(':jqmData(role="content") .gbox3d-2dgv-fullscreen .sprite-32by48').on('webkitTransitionEnd', function() {
                        console.log('arrival!!');
                        move_Object(this, Math.random() * 480/2, Math.random() * 640/2);

                    });

                }

                window.setTimeout(function() {
                    move_Object($('.gbox3d-2dgv-fullscreen .sprite-32by48'), 100, 100);
                }, 100);



//                $(':jqmData(role="content") .gbox3d-2dgv-fullscreen').on('vmousedown', function(evt) {
//                    move_Object(evt.pageX, evt.pageY);
//                });

            });
        </script>

    </head>

    <body>
        <div data-role="page">

            <div data-role='content'>
                <div class="gbox3d-2dgv-fullscreen" >



                </div>
            </div><!-- /content -->

        </div>

    </body>
</html>