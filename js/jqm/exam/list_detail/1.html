<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />

    <title> 리스트뷰와 디테일뷰 구현 1안 </title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>

    <script>
        $(document).bind('mobileinit', function(evt) {
            //리프레쉬버튼을 눌렀을때 시작 페이지로 페이지 초기화를 한다.
            var strTokens = location.href.split('#');
            console.log('size : ' + strTokens.length);
            if (strTokens.length >= 2) {
                location.href = strTokens[0];
                console.log('current page : #' + strTokens[1]);
                console.log('reset startup page');
                return false;
            }
            //$.mobile 관련 전역변수 초기화는 여기서한다.
            $.mobile.autoInitializePage = false;
            console.log('mobile init');
        });
    </script>

    <script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>

    <!-- 자바스크립트는 는 여기에... -->
    <script>

        var App = {};

        App.listdata = [
            {"img_url":"image/tall.jpg","text" : "여자들이 보는 남자의 키 ㅠ.ㅠ;"},
            {"img_url":"image/fox.jpg","text" : "난 괜찬아"},
            {"img_url":"image/father.jpeg","text" : "19금 컨테츠 조기교육"},
            {"img_url":"image/hyodoru.jpeg","text" : "꼬마 효도루"},
            {"img_url":"image/prog.jpg","text" : "프로그래머의 변"},
            {"img_url":"image/toomblady.jpeg","text" : "과학 기술은 위대하다!"}
        ];

        $(function() {
            //페이지 관련 이밴트는 여기서 초기화
            $.mobile.initializePage();
            //도규먼트 객체 관련 이밴트 초기화는 여기서...

            var list_element = $('#page_list :jqmData(role="content") :jqmData(role="listview")');
            $.each(App.listdata,function(index,item) {

                $('<a></a>').text(item.text).appendTo(
                        $('<li></li>').data('myapp-detail',item).appendTo($(list_element))
                );
            });

            $(list_element).listview('refresh');

            $(':jqmData(role="listview") li').on('vmousedown', function(event) {

                var data = $(this).data('myapp-detail');

                var img_url = 'http://1.234.2.201:58080/ohmtide/'+ $(this).data('myapp-detail').img_url;
                var detail_text = $(this).data('myapp-detail').text;

                $('#page_detail :jqmData(role="content") img:eq(0)').attr('src', img_url);
                $('#page_detail :jqmData(role="content") p:eq(0)').text(detail_text);

                $.mobile.changePage('#page_detail', {
                    transition : 'flip',
                    reverse : false,
                    changeHash : true
                });
            });

        });
    </script>
</head>
<!-- HTML 태그들은 여기에... -->
<body>
<div data-role='page' id='page_list' >
    <div data-role='header' data-position="fixed">
        <h1> 재미있는 사진 모아보는앱 </h1>
    </div>
    <div data-role='content'>
        <ul data-role='listview' >

        </ul>
    </div>
    <div data-role='footer' data-position='fixed'>
        <h1> 정보영상진흥원 </h1>
    </div>
</div>

<!---이미지 뷰---->
<div data-role='page' id='page_detail' data-add-back-btn='true'>
    <div data-role='header'  data-position='fixed'>
        <h1> 내용보기 </h1>
    </div>
    <div data-role='content'>
        <p>
        </p>
        <img src=''>
    </div>
    <div data-role='footer' data-position='fixed'>
        <h1> 정보영상진흥원 </h1>
    </div>
</div>
<!-----이미지뷰 끝----------->



</body>
</html>
